# creates IAM user and access key

# sleep 2
# sudo git clone https://github.com/sheldonlsides/detective-env-demo.git
# cd detective-env-demo/
# sudo python ./pythonattacker.py

# internal use only - create IAM user not maintained by Isengard
# user_info=$(aws iam create-user --user-name malicious_user-$starttime)
# username=$( echo $user_info|jq -r '[.User][0]| .UserName' )

# key_info=$(aws iam create-access-key --user-name $username)

# internal use only - creates access id and secret key
# access_id=$( echo $key_info|jq -r '[.AccessKey][0]| .AccessKeyId' ) 
# secret_key=$( echo $key_info|jq -r '[.AccessKey][0]| .SecretAccessKey' ) 

# internal use only - elevate users rights to managed Admin ARN
# aws iam attach-user-policy --user-name $username --policy-arn arn:aws:iam::aws:policy/AdministratorAccess

# change AWS environment credentials
# export AWS_ACCESS_KEY_ID=$access_id
# export AWS_SECRET_ACCESS_KEY=$secret_key
# export AWS_SESSION_TOKEN=""

# list users access keys
# aws iam list-access-keys --user-name $username

# creates new secret in secrets manaer
# aws secretsmanager create-secret --name some_secret_content-$starttime --secret-string $secret_key --description "Stores some user secrets" --region $region